FROM ubuntu-core:latest

LABEL author="ZhangXu <c-all@qq.com>" repositories="https://github.com/calllivecn/dockerbuild/"

RUN apt update \
&& apt -y upgrade \
&& apt -y --no-install-recommends install samba

COPY smb.conf /etc/samba/

ARG PW

RUN bash -xc "echo -e '${PW:-password}\n${PW:-password}' | pdbedit -t -a -u root"

CMD ["smbd","-FS", "-s", "/etc/samba/smb.conf", "-p","445"]

EXPOSE 445

VOLUME /ro /rw
